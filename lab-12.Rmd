---
title: "Lab 12 - Smoking during pregnancy"
author: "Fiona Wang"
date: "Apr 2 2025"
output: github_document
---

### Load packages and data

```{r load-packages, message=FALSE}
library(tidyverse) 
library(tidymodels)
library(openintro)
```

```{r load-data}
data <- ncbirths
```

```{r checktype}
glimpse(data)
```

```{r outlier}
boxplot.stats(data$fage)$out
boxplot.stats(data$mage)$out
boxplot.stats(data$weeks)$out
boxplot.stats(data$visits)$out
boxplot.stats(data$gained)$out
boxplot.stats(data$weight)$out
```

Looking at this tibble, there are a couple numerical variables: father's age, mother's age, length of pregnancy in weeks, number of hospital visits during pregnancy, weight gained by mother during pregnancy in pounds, and weight of the baby at birth in pounds. The others are all categorical. For the numerical variables, all of them have outliers. 

### Exercise 1
There are 1000 cases in this dataset. THe cases are the information on birth record in the state of North Carolina from 2004. 

### Exercise 2
```{r filter}
ncbirths_white <- data %>% 
  filter(whitemom == "white")
ncbirths_white %>% 
  summarise(mean_weight = mean(weight, na.rm = TRUE))
```

The mean weights of the white babies is 7.25 pounds. 

### Exercise 3
I think it meets the criteria necessary to conduct simulation-based inference. It is a large enough sample size, so we could simulate samples easily. The observations are independent, I think. 

### Exercise 4
```{r generatebootstrap}
set.seed(1232)
boot_df <- ncbirths_white %>% 
  specify(respons = weight) %>% 
  hypothesize(null = "point", mu = 7.43) %>% 
  generate(reps = 10000, type  = "bootstrap") %>% 
  calculate(stat = "mean")
glimpse(boot_df)
```

Now, let's plot the graph.
```{r plotdistr}
ggplot(data = boot_df, mapping = aes(x = stat)) +
  geom_histogram(binwidth = 0.001) +
  labs(title = "Null Distribution") +
  geom_vline(xintercept = 7.43, color = "red")
```

It seems to be pretty normally distributed (or a little left skewed), and centered around 7.43. 
```{r pvalue}
boot_df %>% 
  summarize(lower = quantile(stat, .025),
            uppter = quantile(stat, .975))
boot_df %>% 
  summarize(p_value = mean(abs(stat - 7.43) >= abs(7.25 - 7.43)))
```

It seems like the p-value is 0.0007. There is very few instances in the null distribution that we see a difference as large as the one we observed in the current dataset. The null's mean is 7.43, the observed mean is 7.25, which is a 0.18 difference. In our 10,000 bootstrap results, there were few instances where they had a bigger than 0.18 difference. So, it is very unlikely to see an instance as extreme as ours. Thus, we conclude that the weight of White babies in NC in 2004 is significantly lighter than the White babies in 1995. 

### Exercise 5
```{r boxplot}
boxplot(data$weight ~ data$habit, data = data,
        col = c("skyblue", "lightgreen"))
```

From the boxplot, we see that the weight of the babies whose mothers were nonsmokers on average was heavier than that of the babies whose mothers were smokers. 

### Exercise 6
```{r filtermissing}
ncbirths_clean <- data %>% 
  filter(!is.na(habit), !is.na(weight))
```

It seems like there is only one missing value.

### Exercise 7
```{r compareweight}
ncbirths_clean %>% 
  group_by(habit) %>% 
  summarize(mean_weight = mean(weight))
```